---
title: "Age at first Birth"
output: html_notebook
---
```{r git}
use_git_config(user.name="ktemadarko",user.email="k.temadarko@gmail.com")
```



```{r load data}
#library(haven, tidyverse,tidylog,ggforce,ggpubr,scales)
idhs <- read_dta("idhs_00006.dta/idhs_00006.dta")
idhs<-idhs[-c(1:9)]

```

```{r data cleaning}
#dat1<-tibble(idhs)%>%
  #select(c(10,19:60))%>%
  #filter( wkearnsmore<7)

fp<-idhs%>%
  filter(ageat1stbirth<99,resident<2,agefrstmar<99)%>%
  select(-starts_with("rel"),-starts_with("age5"))%>%
  mutate(across(c(urban,resident,marstat), as_factor))
         
fp1<-idhs%>%
  filter(ageat1stbirth<99,resident<2)%>%
  select(-starts_with("rel"),-starts_with("age5"))%>%
  mutate(across(c(urban,resident,marstat), as_factor))
```

```{r factor}
fp=fp%>%
  mutate(across(c(urban,resident,marstat), as_factor))
```

```{r boxplot}
ggplot(fp,aes(ageat1stbirth))+geom_histogram(color="white")+scale_x_continuous(n.breaks=35)+ggtitle("A histogram showing the distribution of age of 1st birth")
p=ggplot(fp,aes(ageat1stbirth,fill=urban))+geom_histogram(color="grey")+scale_x_continuous(n.breaks=12)+ggtitle("A histogram showing the distribution of age of 1st birth")+facet_wrap(~urban)
p
#p+geom_density(alpha=0.2, fill="#aabbcc")


ggplot(fp,aes(urban,ageat1stbirth,fill=urban))+geom_boxplot()+ggtitle("A boxplot showing the distribution of age of 1st birth by urban/rural")

ggplot(fp,aes(x=ageat1stbirth,fill=urban))+geom_histogram(color="grey")+scale_x_continuous(n.breaks=40)+ggtitle("A boxplot showing the distribution of age of 1st birth by urban/rural")

ggplot(fp,aes(x=ageat1stbirth,color=urban,fill=urban))+geom_histogram(position = "dodge")+scale_x_continuous(n.breaks=40)+ggtitle("A histrogram showing the distribution of age of 1st birth by urban/rural")

ggplot(fp,aes(x=as_factor(ageat1stbirth),color=urban,fill=urban))+geom_bar(position = "identity",color="grey")+facet_wrap(ageat1stbirth~.,scales="free")+ggtitle("A histogram showing the distribution of age of 1st birth by urban/rural")

ggplot(fp,aes(x=ageat1stbirth,color=urban,fill=urban))+geom_histogram(position = "identity",color="grey")+scale_x_continuous(n.breaks=40)+ggtitle("A histrogram showing the distribution of age of 1st birth by urban/rural")

ggplot(fp,aes(x=ageat1stbirth,color=urban,fill=urban))+geom_bar(position = "dodge",color="grey")+scale_x_continuous(n.breaks=40)+ggtitle("A histrogram showing the distribution of age of 1st birth by urban/rural")+coord_flip()

#+geom_label(stat="count",aes(label=..count..))
```

```{r age  birth vsersus urban}
facet=ggplot(fp1,aes(x=ageat1stbirth,color=urban,fill=urban))+geom_bar(position = "dodge",color="grey")+scale_x_continuous(breaks=pretty_breaks())+ggtitle("A histogram showing the distribution of age of 1st birth by urban/rural")

facet+facet_zoom(xlim = c(11,14))

facet+facet_zoom(xlim = c(15,25))

facet+facet_zoom(xlim = c(26,34))
```

```{r age_birth va age_married}
b=ggplot(fp1)+scale_x_continuous(n.breaks = 20)
m=ggplot(fp)+scale_x_continuous(n.breaks = 20)

birh=b+geom_histogram(aes(x=ageat1stbirth, fill=urban))+gghighlight(max_highlight = 5L)
birh
birh+facet_wrap(~urban)
  
m+geom_bar(aes(x=agefrstmar, fill=urban,group=urban ),position="dodge")+gghighlight( agefrstmar<19,use_direct_label = FALSE)

chb=b+geom_bar(aes(x=cheb,fill=urban), position="dodge")
#+geom_label(aes(label=cheb))
chb+gghighlight(cheb>6,use_direct_label = FALSE)

#cheb+facet_wrap(urban~.)

cheba=b+geom_point(aes(x=ageat1stbirth,y=cheb,color=urban))+scale_y_continuous(n.breaks = 20)
cheba+gghighlight(cheb>4,label_key = urban)
cheba+facet_wrap(~urban)

marbir=m+geom_point(aes(x=ageat1stbirth,y=agefrstmar,color=urban))+scale_y_continuous(n.breaks = 20)
marbir+gghighlight(agefrstmar<19,label_key = cheb)
marbir+gghighlight(agefrstmar<19,label_key = cheb)+facet_wrap(~urban)

agebirth_cheb<-fp1%>%
  tidycomm::crosstab(cheb,ageat1stbirth,urban)
agebirth_cheb
```

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
